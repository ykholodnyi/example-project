## Example backend project

This is an example [FastAPI](https://fastapi.tiangolo.com/) backend project using [Poetry](https://python-poetry.org/) for dependency management, [SQLAlchemy](https://www.sqlalchemy.org/) as ORM, [Alembic](https://alembic.sqlalchemy.org/en/latest/) for database migrations and for linting - [Flake8](https://flake8.pycqa.org/en/latest/) & [Pylint](https://www.pylint.org/).

### Dependencies

This project uses [Poetry](https://python-poetry.org/) for dependency management.

Poetry is a tool for dependency management and packaging in Python. It allows you to declare the libraries your project depends on and it will manage (install/update) them for you.

Steps for Poetry initialization can be found [here](https://python-poetry.org/docs/basic-usage/).

This project already has `pyproject.toml` file with all dependencies and `poetry.lock` file with all dependencies and their versions.

Some useful commands and example of usage of Poetry in project:

 - Using Poetry for installing dependencies:

    ```bash
    poetry install
    ```

 - Adding new dependency:

    ```bash
    poetry add <dependency>
    ```

 - Removing dependency:

    ```bash
    poetry remove <dependency>
    ```

 - Adding dev dependency (can be used for testing, linting, etc.):

    ```bash
    poetry add <dependency> -D
    ```

 - For creating `requirements.txt` file from `poetry.lock` file use:

    ```bash
    poetry export --output requirements.txt
    ```

### Database migrations

This project uses [Alembic](https://alembic.sqlalchemy.org/en/latest/) for database migrations. Alembic is a lightweight database migration tool for usage with SQLAlchemy. It provides for the creation, management, and invocation of change management scripts for a relational database, and includes a database revision control system.

For creating migrations (revisions) use next command form project environment:

```bash
alembic revision --autogenerate -m "<revision_name>"
```

This command will create new revision file in `alembic/versions` folder if there are any changes in models. 
You can adjust it if needed since it's autogenerated. 
That file will contain all changes that should be applied to database in function `upgrade()` and all changes that should be reverted in function `downgrade()` in case of rollback to previous revision.
After that you can apply this revision to database using next command:

```bash
alembic upgrade head
```

And rollback to previous version (last revision):

```bash
alembic downgrade -1
```

**Important!** All models should be imported in alembic/env.py file, otherwise migrations won't work.

### Linting

This project uses Flake8 and Pylint for linting.

#### Flake8 

Flake8 is a tool that glues together Pyflakes, pycodestyle, McCabe, and third-party plugins to check the style and quality of some python code. Can't be configured with `pyproject.toml` file, require `.flake8` file with config. More details about Flake8 can be found [here](https://flake8.pycqa.org/en/latest/).

To run Flake8 on whole project use:

```bash
flake8 app/
```

To run Flake8 on specific file use:

```bash
flake8 app/main.py
```


#### Pylint

Pylint is a tool that checks for errors in Python code, tries to enforce a coding standard and looks for code smells. Can be configured with `pyproject.toml` file. More details about Pylint can be found [here](https://www.pylint.org/).

To run Pylint on whole project use:

```bash
pylint app/
```

To run Pylint on specific file use:

```bash
pylint app/main.py
```

